---
layout : single
title:  "[Spring]DI ì§€ì‹œì„œ"
last_modified_at : 2022-10-03
categories: spring
toc: true
toc_sticky: true
---

# Spring

## â­Springì‚¬ìš©í•˜ì§€ ì•Šì€ DI

```java
package spring.di;

public class Program {

	public static void main(String[] args) {
		
		Exam exam = new NewlecExam(1,2,3,4);
		ExamConsole console = new GridExamConsole();
		
		console.setExam(exam); // DI
		
		console.print();
	}

}
```
```
>>> 
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  total  â”‚   avg   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    10   â”‚  2.50   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

springì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  `exam`ì´ë¼ëŠ” dependecyë¥¼ ë§Œë“¤ì–´ì„œ `console`ì— injectioní•œ í›„ printí•˜ëŠ” ì½”ë“œì´ë‹¤.   

----

examì´ë¼ëŠ” ê°ì²´ê°€ ë°”ë€Œê±°ë‚˜ consoleì´ ë°”ë€ŒëŠ” ê²½ìš° ì •ì ì¸ ì½”ë“œë¡œ ë°•ì•„ ë†“ì€ê²ƒ ë³´ë‹¤,  
ì„¤ì •íŒŒì¼ë¡œ ë¹¼ì„œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ë°”ëŒì§í•˜ë‹¤ ğŸ‘‰ Springì´ ë„ì™€ì¤Œ

## â­DI ì§€ì‹œì„œ ì‘ì„±
DI ì§€ì‹œì„œë¥¼ ì‘ì„±í•˜ë©´ ë¶€í’ˆì„ ìƒì„±í•˜ê³  ì¡°ë¦½(`setExam`)í•´ì„œ ë°˜í™˜í•´ì¤€ë‹¤!

- ì§€ì‹œì„œ(setting.xml)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<!--Exam exam = new NewlecExam(1,2,3,4); -->
	<bean id="exam" class="spring.di.entity.NewlecExam">
		<!-- exam.setKor(10) -->
		<!-- exam.setEng(20) -->
		<!-- exam.setMath(10) -->
		<!-- exam.setCom(10) -->
		<property name="kor" value="10"/>
		<property name="eng" value="20"/>
		<property name="math" value="10"/>
		<property name="com" value="10"/>
	</bean>
	<!--ExamConsole console = new GridExamConsole(); -->
	<bean id="console" class="spring.di.ui.InlineExamConsole">
		<!--console.setExam(exam); -->
		<property name="exam"  ref="exam"/>
	</bean>
	
</beans>
```

- `<bean />`íƒœê·¸ë¥¼ ì´ìš©í•´ì„œ ìƒì„±í•  ê°ì²´ë¥¼ ì§€ì‹œí•œë‹¤.  

```xml
<bean id="ë³€ìˆ˜ëª…" class="íŒ¨í‚¤ì§€ëª…(ì¤‘ë³µì„ í”¼í•˜ê¸° ìœ„í•´ì„œ) + ê°ì²´í™” í•  í´ë˜ìŠ¤ëª…" /> 
```

### injectionì§€ì‹œ ë‘ ê°€ì§€ ë°©ë²•

#### 1.setter injection
- `<property name="" ref="" ë˜ëŠ” value="">`ë¥¼ ì‚¬ìš©í•˜ì—¬ setterë¥¼ ì´ìš©í•œ injectionì„ ì§€ì‹œí•  ìˆ˜ ìˆë‹¤.  
ì´ë•Œ `<property>`íƒœê·¸ ì•ˆ nameì€ `console.setExam(exam)`ì˜ setExamì—ì„œ setì„ ì§€ìš°ê³  Examì˜ Eë¥¼ ì†Œë¬¸ìë¡œ ë°”ê¾¼ `exam`ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•œë‹¤.(ê·œì¹™)  

#### 2.ìƒì„±ì injection 
- `<constructor-arg index="" value="" />`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ìë¥¼ ì´ìš©í•œ injectionì„ ì§€ì‹œí•  ìˆ˜ ìˆë‹¤.  
```xml
    <!--Exam exam = new NewlecExam(10,20,40,30); -->
	<bean id="exam" class="spring.di.entity.NewlecExam">
		<constructor-arg index="0" type="int" value="10" />
		<constructor-arg index="1" type="int" value="20" />
		<constructor-arg index="com" type="int" value="30" />
		<constructor-arg index="math" type="int" value="40" />
	</bean>
```

- ì„¤ì • íŒŒì¼ ì²˜ë¦¬ê¸°ë¥¼ setting.xmlì— ì¶”ê°€(namespaceì—ì„œ pë¥¼ ì¶”ê°€)í•˜ë©´ ì¢€ ë” ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤.

```xml
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
    <bean id="exam" class="spring.di.entity.NewlecExam" p:kor="10" p:eng="10"/>
</beans>
```


## â­Springì‚¬ìš©í•œ DI


```java
package spring.di;

import org.springframework.context.ApplicationContext;
...

public class Program {

	public static void main(String[] args) {
		
		ApplicationContext context 
			= new ClassPathXmlApplicationContext("spring/di/setting.xml");
		
		//ExamConsole console = (ExamConsole) context.getBean("console");
		ExamConsole console = context.getBean(ExamConsole.class);
		
		console.print();
	}
}
```

ApplicationContext *(maven projectë¡œ ë°”ê¿”ì„œ pom.xmlì— dependencyë¥¼ ì¶”ê°€í•œ í›„ importí•´ì•¼ í•œë‹¤)* ë¥¼ ì´ìš©í•˜ì—¬ ì‘ì„±í•œ ì§€ì‹œì„œë¥¼ ì½ì–´ì˜¬ ìˆ˜ ìˆë‹¤.  

ApplicationContextëŠ” ì¸í„°í˜ì´ìŠ¤ì´ê³ , ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆë‹¤. 
1. ClassPathXmlApplicationContext
2. FileSystemXmlApplicationContext
3. XmlWebApplicationContext
4. AnnotationConfigApplicationContext  

### - getBeaní•˜ëŠ” ë°©ë²• ë‘ ê°€ì§€
- ì´ë¦„ : context.getBean("console")ë¡œ ê°€ì ¸ì˜¤ë©´ Objectí˜•ìœ¼ë¡œ ë°˜í™˜ë˜ë¯€ë¡œ castingì„ í•´ì•¼í•œë‹¤

- ìë£Œí˜• : context.getBean(ExamConsole.class)ë¡œ ê°€ì ¸ì˜¤ë©´ castingì´ í•„ìš”ì—†ë‹¤




















