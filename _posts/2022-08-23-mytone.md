---
layout : single
title:  "MyTone"
last_modified_at : 2022-08-24
categories: mytone
toc: true
toc_sticky: true
---
# 퍼스널컬러 진단 웹사이트

## 제작동기
최근 퍼스널 컬러에 대한 높은 관심도와 퍼스널 컬러 진단 서비스 시장의 폭발적인 성장 여력을 바탕으로 주제를 선정하였고, 프로젝트를 진행하였습니다. 

----

프론트엔드(React)로 프로젝트에 참여했으며 사용자 인증과, 게시판 기능을 구현했습니다.

## 구현기능
- 로그인, 로그아웃, 회원가입 (jwt를 사용한 회원인증)
- 게시판 CRUD, 댓글과 대댓글 CRUD

## 로그인, 로그아웃, 회원가입 (jwt를 사용한 회원인증)

- 회원가입

```js
function SignUp() {
    ...
    return (
        ...
            <Form action="/" className="form-top"
                onSubmit={function (e) {
                    e.preventDefault();
                    axios.post('/user/register/', {
                        username: e.target.username.value,
                        password1: e.target.password1.value,
                        password2: e.target.password2.value,
                        nickname: e.target.nickname.value,
                        gender: e.target.gender.value == 'femail' ? 'W' : 'M'
                    }).then((res) => {
                        if (res.status == 200) { // 가입 성공
                            alert(res.data.message);
                            navigate('/signin')
                        } else { // 가입 실패
                            alert('가입 실패!!');
                        }
                    }).catch((err) => {
                        console.log(err);
                    })
                }}>
                ...
            </Form>
    );

}
export default SignUp
```
`<form>`태그를 사용하였고, axios를 사용해서 서버로 post하였다.  
이때 `e.preventDefault()`는 form 안에 submit역할을 하는 버튼을 눌렀어도 화면을 새로고침 하지않기 위해서 사용했다.(submit은 작동됨)

----

- 로그인

```js
<form onSubmit={(e) => {
    e.preventDefault();
    axios.post('/user/login/', {
        username: e.target.username.value,
        password: e.target.password.value,
    })
    .then((res) => {
          if (res.status == 200) {
              alert(res.data.message)
              localStorage.setItem('UserID', res.data.token.user);
              setRefreshToken(res.data.token.refresh_token);
              dispatch(setAuthToken(res.data.token.access_token));
              navigate('/');
          }
        })
    .catch((err) => {
          if (err.response.status == 400) {
              alert('아이디 혹틀렸습니다')
          }
          setValue("password", "");
        })
  }>
```

서버로 post요청이 성공하면 response로 accessToken과 refreshToken을 받는다.  
> accessToken : redux store  
refreshToken : 쿠키  

accessToken의 경우 탈취의 위험이 있기 때문에 브라우저 저장소가 아닌 store에 저장한다.  

store에 저장하면 브라우저를 새고로침 할때 초기화 된다. 이를 해결하기 위해 새로고침 될 때마다 로그인을 연장시켜 줘야한다.  











